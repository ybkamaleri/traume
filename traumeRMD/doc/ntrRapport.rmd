---
params:
  dynamictitle: "My report"
  reportdate: !r Sys.Date()
  dynamicSub: "My subtitle"
title: "`r paste0('NTR rapport for ', params$dynamictitle)`"
date: "`r params$reportdate`"
subtitle: "`r paste0('Utvalgte tidsperioden er fra ', params$dynamicSub)`"
---

```{r setup, echo=FALSE, message=TRUE, warning=TRUE, include=FALSE}


## Knitr opt
## ===========
knitr::opts_chunk$set(
  ## fig.path = paste0('figures/ntr-', Hospital), #mappe for figurer
  echo = FALSE,
  message = FALSE,
  warning = FALSE,
  include = TRUE)


## DATA
## =====

hospValg <- input$hosp_rapport
datoFra <- input$dato_rapport[1]
datoTil <- input$dato_rapport[2]

## Traumeskjema
masterDT <- masterFile[!duplicated(ntrid) &
                    Hospital == (hospValg) &
                      dateSykehus >= as.POSIXct(datoFra, format = "%Y-%m-%d") &
                       dateSykehus <= as.POSIXct(datoTil, format = "%Y-%m-%d"), ]

antallNTR <- dim(masterDT)[1]

## Akuttskjema
dataDT <- akutt[!duplicated(ntrid) &
                    Hospital == (hospValg) &
                      dateSykehus >= as.POSIXct(datoFra, format = "%Y-%m-%d") &
                       dateSykehus <= as.POSIXct(datoTil, format = "%Y-%m-%d"), ]

## antallNTR <- dim(dataDT)[1]


## Skadeskjema
skadeDT <- skade[!duplicated(ntrid) &
                    !is.na(ntrid) &
                   Hospital == (hospValg) &
                    dateSykehus >= as.POSIXct(datoFra, format = "%Y-%m-%d") &
                       dateSykehus <= as.POSIXct(datoTil, format = "%Y-%m-%d"),]


## Ulykkeskjema
ulykkeDT <- ulykke[!duplicated(ntrid) &
                    !is.na(ntrid) &
                   Hospital == (hospValg) &
                    dateSykehus >= as.POSIXct(datoFra, format = "%Y-%m-%d") &
                       dateSykehus <= as.POSIXct(datoTil, format = "%Y-%m-%d"),]


## prehospitalskjema
prehospDT <- prehosp[!duplicated(ntrid) &
                    !is.na(ntrid) &
                   Hospital == (hospValg) &
                    dateSykehus >= as.POSIXct(datoFra, format = "%Y-%m-%d") &
                    dateSykehus <= as.POSIXct(datoTil, format = "%Y-%m-%d"),]

## Intensiv
intDT <- intensiv[!duplicated(ntrid) &
                   !is.na(ntrid) &
                    Hospital == (hospValg) &
                    dateSykehus >= as.POSIXct(datoFra, format = "%Y-%m-%d") &
                    dateSykehus <= as.POSIXct(datoTil, format = "%Y-%m-%d"),]


## Tilgjengelige data
minDato <- min(as.POSIXct(dataDT$dateSykehus, format = "%Y-%m-%d"))
maxDato <- max(as.POSIXct(dataDT$dateSykehus, format = "%Y-%m-%d"))



```

# Antall traume

Det er `r antallNTR` traumer ble rapported og gyldige data er fra `r format(as.Date(minDato), '%d.%m.%Y')` til `r format(as.Date(maxDato), '%d.%m.%Y')`. Hvis valgte perioden ikke er samsvar med perioden for gyldige data betyr det at det ikke finnes data som er tilgjengelige i databasen for den valgte tidsperioden.

# Alarm

Antall traume med eller uten alarm.


